# -*- coding: utf-8 -*-
"""Adaptive Filter ECG.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cQGrycSnNOTeQRLqsFBQGcRZWQSh9llX

# **Imports**
"""

import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from scipy.fft import rfft, rfftfreq, fft, fftfreq

"""# **Working with Dataset**"""

data = pd.read_csv('/content/drive/MyDrive/Shamim/100.csv')
COLUMNS = ['Time', 'V5']

data = data.iloc[1:]
data = data.drop(["'MLII'"], axis=1)
data.columns = COLUMNS
data

data.V5 = data.V5.apply(float)

"""# **Signal Processing**

### **Create Noise**
"""

x = np.linspace(0, 10, 3600, endpoint=False)
y = 0.2*np.sin((2*np.pi)* x*50)

len(y)

plt.figure(figsize=(8, 5))
plt.plot(x, y)
# plt.xlim(0, 10)
plt.title("Noise Signal VS Time", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('Time', fontdict={"size":14})
plt.ylabel('Voltage', fontdict={"size":14})
plt.show()
plt.show()

"""### **Create Noisy ECG Signal**"""

ecg = np.array(data.V5.to_list())

noisy_ecg = y + ecg # sum

plt.figure(figsize=(8, 5))
plt.plot(noisy_ecg[:450])
plt.title("Noisy ECG Signal VS Samples (From 1th sample to 450th sample)", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('Samples', fontdict={"size":14})
plt.ylabel('Voltage', fontdict={"size":14})
plt.show()

yf = fft(noisy_ecg)
xf = fftfreq(n=3600, d=1/360)

plt.figure(figsize=(8, 5))
plt.plot(xf, np.abs(yf))
plt.title("Amplitude Spectrum of noisy ECG Signal with fft", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('frequency', fontdict={"size":14})
plt.ylabel('|amplitude|', fontdict={"size":14})
plt.show()

ecg_rf = np.abs(rfft(ecg))
xf2 = rfftfreq(n=3600, d=1/360)

plt.figure(figsize=(12, 5))
plt.plot(xf2, ecg_rf)
# plt.xlim(-10, 100)
plt.title("Amplitude Spectrum of  ECG Signal with rfft", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('frequency', fontdict={"size":14})
plt.ylabel('|amplitude|', fontdict={"size":14})
plt.show()


noisy_ecg_rf = np.abs(rfft(noisy_ecg))
xf1 = rfftfreq(n=3600, d=1/360)

plt.figure(figsize=(12, 5))
plt.plot(xf1, noisy_ecg_rf)
# plt.xlim(-10, 100)
plt.title("Amplitude Spectrum of noisy ECG Signal with rfft", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('frequency', fontdict={"size":14})
plt.ylabel('|amplitude|', fontdict={"size":14})
plt.show()

"""## **Create FIR Adaptivie Filter with LMS Algorithm**

### **FIR filter formula**

![5.png](data:image/png;base64,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)

### **MSE formula:**

![6.png](data:image/png;base64,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)
"""

# Create FIR Filter with LMS algorithm

coefs = [1.1, 0.51, 0.41, 1, 0.7]

complete = False

coefs1 = []

while not complete:
  output = []
  print(coefs)
  coefs1.append(coefs[0])

  for i in range(len(noisy_ecg)):
    # FIR filter Formula
    output.append(coefs[0]*noisy_ecg[i] + coefs[1]*noisy_ecg[i-1] + coefs[2]*noisy_ecg[i-2]
                  + coefs[3]*noisy_ecg[i-3]+ coefs[4]*noisy_ecg[i-4])

  output_f = abs(rfft(output))
  error_list = []
  mse = 0
  
  mse = np.square(np.subtract(output_f, ecg_rf)).mean()
  print(mse)
  if 0<mse<2.39:
    complete = True

  else:
    # print(len(coefs))
    e = []
    for n in range(len(ecg)):
      e.append(ecg[n] - output[n])

    for i in range(len(coefs)):
      for n in range(len(ecg)):
        mu = 0.001
        coefs[i] += 2 * mu * e[n] * noisy_ecg[n]

  

print(len(output))

for i in coefs1:
  print(i)

plt.plot(coefs1)

# mse

# coefs
xf3 = rfftfreq(n=3600, d=1/360)
output_f = abs(rfft(output))
plt.figure(figsize=(15, 5))
plt.plot(xf3, output_f)
plt.title("Amplitude Spectrum of cleaned noisy ECG Signal with rfft", fontdict={"size":16, 'weight': 'bold'})
plt.xlabel('frequency', fontdict={"size":14})
plt.ylabel('|amplitude|', fontdict={"size":14})
plt.show()

